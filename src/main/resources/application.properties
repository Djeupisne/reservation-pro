# Application name
spring.application.name=${SPRING_APPLICATION_NAME}

# Server configuration
server.port=${SERVER_PORT:8080}

# Database connection
spring.datasource.url=${SPRING_DATASOURCE_URL}
spring.datasource.username=${SPRING_DATASOURCE_USERNAME}
spring.datasource.password=${SPRING_DATASOURCE_PASSWORD}
spring.datasource.driver-class-name=${SPRING_DATASOURCE_DRIVER_CLASS_NAME}

# Database connection pool
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.maximum-pool-size=10
spring.datasource.hikari.minimum-idle=2

# Flyway configuration
spring.flyway.enabled=${SPRING_FLYWAY_ENABLED:false}
spring.flyway.locations=${SPRING_FLYWAY_LOCATIONS:classpath:db/migration}
spring.flyway.baseline-on-migrate=${SPRING_FLYWAY_BASELINE_ON_MIGRATE:true}
spring.flyway.baseline-version=${SPRING_FLYWAY_BASELINE_VERSION:0}
spring.flyway.validate-on-migrate=true

# JPA / Hibernate
spring.jpa.hibernate.ddl-auto=${SPRING_JPA_HIBERNATE_DDL_AUTO:update}
spring.jpa.show-sql=${SPRING_JPA_SHOW_SQL:true}
spring.jpa.open-in-view=${SPRING_JPA_OPEN_IN_VIEW:false}
spring.jpa.properties.hibernate.dialect=${SPRING_JPA_DATABASE_PLATFORM}
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# Disable SQL initialization to avoid conflicts with Flyway
spring.sql.init.mode=${SPRING_SQL_INIT_MODE:never}

# CORS Configuration (IMPORTANT pour le frontend Angular)
spring.web.cors.allowed-origins=${CORS_ALLOWED_ORIGINS:https://reservation-pro-frontend.onrender.com,http://localhost:4200}
spring.web.cors.allowed-methods=${CORS_ALLOWED_METHODS:GET,POST,PUT,DELETE,PATCH,OPTIONS}
spring.web.cors.allowed-headers=${CORS_ALLOWED_HEADERS:*}
spring.web.cors.allow-credentials=${CORS_ALLOW_CREDENTIALS:true}
spring.web.cors.max-age=${CORS_MAX_AGE:3600}

# Email configuration
spring.mail.host=${SPRING_MAIL_HOST}
spring.mail.port=${SPRING_MAIL_PORT:587}
spring.mail.username=${SPRING_MAIL_USERNAME}
spring.mail.password=${SPRING_MAIL_PASSWORD}
spring.mail.properties.mail.smtp.auth=${SPRING_MAIL_PROPERTIES_MAIL_SMTP_AUTH:true}
spring.mail.properties.mail.smtp.starttls.enable=${SPRING_MAIL_PROPERTIES_MAIL_SMTP_STARTTLS_ENABLE:true}
spring.mail.properties.mail.smtp.starttls.required=${SPRING_MAIL_PROPERTIES_MAIL_SMTP_STARTTLS_REQUIRED:true}
spring.mail.from=${SPRING_MAIL_FROM:noreply@agencevoyage.com}

# RabbitMQ configuration (désactivé)
spring.rabbitmq.host=${SPRING_RABBITMQ_HOST:localhost}
spring.rabbitmq.port=${SPRING_RABBITMQ_PORT:5672}
spring.rabbitmq.username=${SPRING_RABBITMQ_USERNAME:guest}
spring.rabbitmq.password=${SPRING_RABBITMQ_PASSWORD:guest}

# DÉSACTIVER RabbitMQ COMPLÈTEMENT
spring.autoconfigure.exclude=org.springframework.boot.autoconfigure.amqp.RabbitAutoConfiguration

# Logging
logging.level.root=${LOGGING_LEVEL_ROOT:INFO}
logging.level.tg.agence_voyage=${LOGGING_LEVEL_APP:DEBUG}
logging.level.org.springframework=${LOGGING_LEVEL_SPRING:INFO}
logging.level.org.springframework.web=${LOGGING_LEVEL_WEB:INFO}
logging.level.org.springframework.security=${LOGGING_LEVEL_SECURITY:INFO}
logging.level.org.hibernate.SQL=${LOGGING_LEVEL_SQL:DEBUG}
logging.level.org.hibernate.orm.jdbc.bind=${LOGGING_LEVEL_BIND:TRACE}
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=${LOGGING_LEVEL_BINDER:TRACE}
logging.level.org.flywaydb=${LOGGING_LEVEL_FLYWAY:DEBUG}
logging.level.org.springframework.context=${LOGGING_LEVEL_CONTEXT:INFO}

# Actuator (health check pour Render)
management.endpoints.web.exposure.include=health,info,metrics
management.endpoint.health.show-details=always
management.endpoint.health.probes.enabled=true

# JWT configuration
jwt.secret=${JWT_SECRET:your-super-secret-jwt-key-change-this-in-production}
jwt.expiration=${JWT_EXPIRATION:86400000}
jwt.issuer=${JWT_ISSUER:agence-voyage-app}

# File upload
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# Server error handling
server.error.include-stacktrace=never
server.error.include-message=always
server.error.include-binding-errors=always

# Spring MVC
spring.mvc.format.date=yyyy-MM-dd
spring.mvc.format.date-time=yyyy-MM-dd HH:mm:ss
spring.mvc.format.time=HH:mm:ss

# Security (basic pour commencer)
spring.security.user.name=${SECURITY_USERNAME:admin}
spring.security.user.password=${SECURITY_PASSWORD:admin123}
spring.security.user.roles=${SECURITY_ROLES:USER,ADMIN}